<title>Gestion Participants</title>
<table>
    <tr>

        <td>mail</td>
        <td>nom</td>
        <td>prenom</td>
        <td>telephone</td>
        <td>username</td>
        <td>Somme Due totale</td>
        <td>Formations suivies</td>
        <td>Supprimer ce participant</td>
        <td>Modifier ce participant</td>
        <td>Afficher Paiements</td>
        <td> Afficher ce que ce participant doit encore payer</td>
        <td> Enlever participants des formations</td>

    </tr>
    
    <tr *ngFor = "let p of ListeParticipant" >

        <td>{{p.mail}}</td>
        <td>{{p.nom}}</td>
        <td>{{p.prenom}}</td>
        <td>{{p.telephone}}</td>
        <td>{{p.username}}</td>
        <td>{{p.sommeDue}}</td>
        <td>
            <tr *ngFor = "let f of p.formations" >
                <td>{{f.nom}}</td>
            </tr>
        </td>
        <td><button (click)="supprimerParticipant(p.id)">Supprimer ce Participant</button></td>
        <td><button (click)="modifierParticipant(p)">Modifier ce Participant</button></td>
        <td><button (click)="paiementsParticipant(p)">Consulter Paiements de ce participant</button></td>
        <td><button (click)="restantAPayerParticipant(p)">Consulter ce que ce participant doit encore payer</button></td>
        <td><button (click)="EnleverParticipantFormations(p)">Enlever ce participant des formations</button></td>

    </tr>
</table>
<br>
<h2>Ajouter/Modifier un participant</h2>

<form  #form="ngForm" (ngSubmit)="ajouterParticipant(form)">
    id : <input type="number" name="id" [(ngModel)]="ParticipantAAjouter.id" [hidden]="true"> 
    mail : <input type="text" name="mail" [(ngModel)]="ParticipantAAjouter.mail"> 
    nom : <input type="text" name="nom" [(ngModel)]="ParticipantAAjouter.nom">
    prenom : <input type="text" name="prenom" [(ngModel)]="ParticipantAAjouter.prenom">
    telephone : <input type="number" name="telephone" [(ngModel)]="ParticipantAAjouter.telephone">
    username : <input type="text" name="username" [(ngModel)]="ParticipantAAjouter.username">
   <!--password : <input type="text" name="password" [(ngModel)]="ParticipantAAjouter.password">--> 
  
    Formation :
      
    <div *ngFor="let formation of ListeFormation">
        <input type="checkbox" (change)="toggleSelection(formation.id)" [checked]="listeIdFormation.includes(formation.id)">
        {{formation.nom}}
      </div>
      
    <button type="submit">Ajouter Participant</button>
</form>

<div *ngIf="ListePaiement.length!=0">

    <h2>Paiements relatif au participant</h2>
    <tr>
        <td>id</td>
        <td>date</td>
        <td>mode</td>
        <td>montant</td>
    </tr>

    <tr *ngFor = "let p of ListePaiement" >
        <td>{{p.id}}</td>
        <td>{{p.date}}</td>
        <td>{{p.mode}}</td>
        <td>{{p.montant}}</td>
    </tr>
    <button (click)="effacerPaiement()">Effacer la liste des paiements</button>

  </div>

  <div *ngIf="Message!=null">
    <p>{{Message}}</p>
  </div>

  <div *ngIf="SommeRestantAPayer!=null">
    <h2> Ce que doit ce participant </h2>
    <p>Ce participant doit encore {{SommeRestantAPayer}} â‚¬</p>
  </div>
